<div class="sf-container">
    <header class="sf-header">
        <h1 class="sf-title">Sai Fashions</h1>
        <p class="sf-subtitle">Quickly click & create product label</p>
    </header>

    <!-- Camera -->
    <div class="sf-camera">
        <button class="sf-camera-btn" (click)="onCameraClick(cameraInput)">ðŸ“¸ Take Photo</button>
        <input #cameraInput type="file" accept="image/*" capture="environment" (change)="onFileSelected($event)" hidden>
    </div>

    <!-- Custom Cropper -->
    <div *ngIf="previewUrl && !cropConfirmed" class="crop-container">
        <img [src]="previewUrl" class="crop-image" #imageRef (load)="onImageLoad(imageRef)">

        <!-- Crop Box -->
        <div class="crop-box" [style.left.px]="cropBox.left" [style.top.px]="cropBox.top"
            [style.width.px]="cropBox.width" [style.height.px]="cropBox.height" (mousedown)="startDrag($event)"
            (touchstart)="startDrag($event)">

            <!-- Resize handles -->
            <div class="handle tl" (mousedown)="startResize($event,'tl')" (touchstart)="startResize($event,'tl')"></div>
            <div class="handle tr" (mousedown)="startResize($event,'tr')" (touchstart)="startResize($event,'tr')"></div>
            <div class="handle bl" (mousedown)="startResize($event,'bl')" (touchstart)="startResize($event,'bl')"></div>
            <div class="handle br" (mousedown)="startResize($event,'br')" (touchstart)="startResize($event,'br')"></div>
            <div class="handle t" (mousedown)="startResize($event,'t')" (touchstart)="startResize($event,'t')"></div>
            <div class="handle b" (mousedown)="startResize($event,'b')" (touchstart)="startResize($event,'b')"></div>
            <div class="handle l" (mousedown)="startResize($event,'l')" (touchstart)="startResize($event,'l')"></div>
            <div class="handle r" (mousedown)="startResize($event,'r')" (touchstart)="startResize($event,'r')"></div>
        </div>
    </div>

    <div *ngIf="previewUrl && !cropConfirmed" class="sf-cropper-btns">
        <button class="sf-generate-btn" (click)="confirmCrop()">âœ… Confirm Crop</button>
        <button class="sf-generate-btn" (click)="resetCrop()">ðŸ”„ Reset Crop</button>
    </div>

    <!-- Cropped Preview -->
    <img *ngIf="cropConfirmed && croppedPreviewUrl" [src]="croppedPreviewUrl" alt="preview" class="sf-preview">

    <!-- Form -->
    <div class="sf-form">
        <input [(ngModel)]="price" placeholder="Price (e.g. â‚¹499)">
        <div class="sf-autocomplete" (mouseleave)="hideSuggestions()">
            <input [(ngModel)]="size" placeholder="Size (e.g. M/L/XL)" (input)="filterSizes()" (focus)="filterSizes()"
                autocomplete="off">
            <ul *ngIf="showSuggestions && filteredSizes.length > 0">
                <li *ngFor="let option of filteredSizes" (mousedown)="selectSize(option)">
                    {{ option }}
                </li>
            </ul>
        </div>
        <textarea [(ngModel)]="desc" rows="2" placeholder="One-line description (e.g. Cotton kurta)"></textarea>

        <button class="sf-generate-btn" (click)="generateImage()" [disabled]="isLoading">
            {{ isLoading ? 'Processingâ€¦' : 'Generate & Download' }}
        </button>
    </div>

    <footer class="sf-footer">
        <p>Developed By: Sahil Dhanwani v2.0</p>
    </footer>
</div>